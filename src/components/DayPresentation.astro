---
import { flaNames } from "../constants";
import { ctcNames, seaNames } from "../constants";

interface Props {
  user: {
    name: string;
    id: string;
  };
  temp: {
    stateSky: {
      description: string;
    };
    temperaturas: {
      max: string;
      min: string;
    };
    viento: string;
  };
  flags: {
    updateDate: string;
    name: string;
    flag: number;
    id: number;
    seaState: number;
    seaCapacity: number;
  }[];
}

interface FlagDataTypes {
  updateDate: string;
    name?: string;
    flag: number;
    id?: number;
    seaState: number;
    seaCapacity: number;
}

const { user, temp, flags } = Astro.props;
const hour = new Date().getHours();

const msg =
  hour > 6 && hour < 14
    ? "Buenos días"
    : hour < 21
      ? "Buenas tardes"
      : "Buenas noches";

const getFlagData = (id: number): FlagDataTypes => {
  const beach = flags.find((elm) => elm.id === id);
  return (
    beach || {
      flag: 100,
      seaState: 0,
      seaCapacity: 1000,
      updateDate:"Sin datos"
    }
  );
};
---

<h2 class="pt-10 font-semibold">¡{msg} {user.name}!</h2>

<div class="pt-10">
  <h4 class="text-lg font-semibold text-left pb-3 lg:text-center">
    Previsión meteorológica para hoy:
  </h4>
  <ul class="text-base lg:flex lg:justify-center">
    <li class="font-semibold lg:pr-10">{temp?.stateSky?.description}</li>
    <li>
      Tª. Max: <span class="font-semibold lg:pr-10"
        >{temp?.temperaturas?.max}º</span
      >
    </li>
    <li>
      Tª. Min: <span class="font-semibold lg:pr-10"
        >{temp?.temperaturas?.min}º</span
      >
    </li>
    <li>Viento: <span class="font-semibold">{temp?.viento} km/h</span></li>
  </ul>
</div>

<div class="py-10">
  <h4 class="text-lg font-semibold text-left pb-3 lg:text-center">
    Estado playas:
  </h4>
  <ul class="text-base lg:flex lg:justify-center">
    <li class="pb-5 lg:pr-10">
      <p class="font-semibold flex lg:justify-center">
        Cabo de Palos <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          style={{ fill: flaNames[getFlagData(1000625)?.flag] }}
          class="size-6 ml-3"
        >
          <path
            d="M3 2.25a.75.75 0 0 1 .75.75v.54l1.838-.46a9.75 9.75 0 0 1 6.725.738l.108.054A8.25 8.25 0 0 0 18 4.524l3.11-.732a.75.75 0 0 1 .917.81 47.784 47.784 0 0 0 .005 10.337.75.75 0 0 1-.574.812l-3.114.733a9.75 9.75 0 0 1-6.594-.77l-.108-.054a8.25 8.25 0 0 0-5.69-.625l-2.202.55V21a.75.75 0 0 1-1.5 0V3A.75.75 0 0 1 3 2.25Z"></path>
        </svg>
      </p>
      <p class="pl-3 lg:pl-0">
        Estado mar: <span class="font-semibold lg:pr-10"
          >{seaNames[getFlagData(1000625)?.seaState]}</span
        >
      </p>
      <p class="pl-3 lg:pl-0">
        Aforo: <span class="font-semibold lg:pr-10"
          >{ctcNames[getFlagData(1000625)?.seaCapacity]}</span
        >
      </p>
      <p class="pl-3 lg:pl-0">
        Actualizado: <span class="lg:pr-10"
          >{getFlagData(1000625)?.updateDate}</span
        >
      </p>
    </li>
    <li class="pb-5 lg:pr-10">
      <p class="font-semibold flex lg:justify-center">
        Playa Galua<svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          style={{ fill: flaNames[getFlagData(1000624)?.flag] }}
          class="size-6 ml-3"
        >
          <path
            fill-rule="evenodd"
            d="M3 2.25a.75.75 0 0 1 .75.75v.54l1.838-.46a9.75 9.75 0 0 1 6.725.738l.108.054A8.25 8.25 0 0 0 18 4.524l3.11-.732a.75.75 0 0 1 .917.81 47.784 47.784 0 0 0 .005 10.337.75.75 0 0 1-.574.812l-3.114.733a9.75 9.75 0 0 1-6.594-.77l-.108-.054a8.25 8.25 0 0 0-5.69-.625l-2.202.55V21a.75.75 0 0 1-1.5 0V3A.75.75 0 0 1 3 2.25Z"
            clip-rule="evenodd"></path>
        </svg>
        <p class="pl-3 lg:pl-0">
          Estado mar: <span class="font-semibold lg:pr-10"
            >{seaNames[getFlagData(1000624)?.seaState]}</span
          >
        </p>
        <p class="pl-3 lg:pl-0">
          Aforo: <span class="font-semibold lg:pr-10"
            >{ctcNames[getFlagData(1000624)?.seaCapacity]}</span
          >
        </p>
        <p class="pl-3 lg:pl-0">
          Actualizado: <span class="lg:pr-10"
            >{getFlagData(1000624)?.updateDate}</span
          >
        </p>
      </p>
      <li>
        <p class="font-semibold flex lg:justify-center">
          Playa Azohía <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            style={{ fill: flaNames[getFlagData(1022925)?.flag] }}
            class="size-6 ml-3"
          >
            <path
              fill-rule="evenodd"
              d="M3 2.25a.75.75 0 0 1 .75.75v.54l1.838-.46a9.75 9.75 0 0 1 6.725.738l.108.054A8.25 8.25 0 0 0 18 4.524l3.11-.732a.75.75 0 0 1 .917.81 47.784 47.784 0 0 0 .005 10.337.75.75 0 0 1-.574.812l-3.114.733a9.75 9.75 0 0 1-6.594-.77l-.108-.054a8.25 8.25 0 0 0-5.69-.625l-2.202.55V21a.75.75 0 0 1-1.5 0V3A.75.75 0 0 1 3 2.25Z"
              clip-rule="evenodd"></path>
          </svg>
        </p>
        <p class="pl-3 lg:pl-0">
          Estado mar: <span class="font-semibold lg:pr-10"
            >{seaNames[getFlagData(1022925)?.seaState]}</span
          >
        </p>
        <p class="pl-3 lg:pl-0">
          Aforo: <span class="font-semibold lg:pr-10"
            >{ctcNames[getFlagData(1022925)?.seaCapacity]}</span
          >
        </p>
        <p class="pl-3 lg:pl-0">
          Actualizado: <span class="lg:pr-10"
            >{getFlagData(1022925)?.updateDate}</span
          >
        </p>
      </li>
    </li>
  </ul>
</div>
